| {% block body %}

#node-container.texture
	each val in [1,2,3,4,5]
		section.node-row
			section.node-preview.texture
				| {% if node.picture %}
				img.node-preview-thumbnail(src="{{ node.picture.thumbnail('l', api=api) }}")
				| {% endif %}


			section.node-details-container.texture

				.node-details-header
					.node-title
						| {{node.name}}

				.node-details-attributes
					span.sizes
						| {{ node.picture.width }}
						small x
						| {{ node.picture.height }}

					span.variations
						span Color

					span.extra
						i.pi-puzzle
						| Seamless


				.node-details-meta
					ul.node-details-meta-list
						li.node-details-meta-list-item.type
							| {{ node.properties.content_type }}

						li.node-details-meta-list-item.image.length
							| {{ node.file.length | filesizeformat }}

						li.node-details-meta-list-item.image.download
							| {% if node.file.link %}
							a(href="{{ node.file.link }}")
								button.btn.btn-default(type="button")
									| Download Texture
							| {% else %}
							a(href="#")
								button.btn.btn-default.disabled(type="button")
									| Download Texture
							| {% endif %}

	#comments-container.texture
		#comments-list-items-loading
			i.pi-spin

include ../../_scripts

| {% endblock %}

| {% block footer_scripts %}
script.
	// Generate GA pageview
	ga('send', 'pageview', (location.pathname + '#' + '{{node._id}}'));

	var src = $('.node-preview-thumbnail').attr('src');
	var src_xl = src.replace('-l', '-h');
	var src_xl_width, src_xl_height;

	$('.node-preview-thumbnail').each(function(i){

		$(this).hover(
			function(){
				var preview = $(this);

				/* Replace image src with larger one */
				$(this).attr('src', src_xl);

				/* Make dummy img in memory otherwise we have css issues */
				$("<img/>")
					.attr('src', src_xl)
					.load(function(){
						src_xl_width = this.width;
						src_xl_height = this.height;
				});

				$(preview).css({width: src_xl_width + 'px', height: src_xl_height + 'px'});

				var parent = $(preview).parent();
				var parentOffset = parent.offset();

				$(document).on('mousemove', function(e){
					$(preview).css({
						left:  e.pageX - parentOffset.left - (src_xl_width / 2),
						top:   e.pageY - parentOffset.top - (src_xl_height / 2)
					});
				});
			},
			function(){
				$(document).off('mousemove');
				$(this).attr('src', src);

				$(this).css({left: 0, top: 0, width: '100%', height: 'auto'});

			}
		);

	});


	$('.join-us').click(function() {
		$.get('/403', function(data) {
			$('#node-container').html(data);
			$('#error_container').css('display', 'flex');
		})
	});

| {% endblock %}

