| {% extends 'layout.html' %}

| {% block page_title %}Project {{ project.name }}{% endblock %}

| {% block header_backdrop %}
| {% if project.picture_header %}
.navbar-backdrop(style="background-image: url({{ project.picture_header.thumbnail('m', api=api) }})")
| {% else %}
.navbar-backdrop
| {% endif %}
.navbar-backdrop-overlay
| {% endblock %}


| {% block body %}
.container.box
	form(
		method='POST',
		action="{{url_for('projects.edit_node_type', project_url=project.url, node_type_name=node_type['name'])}}")

		#blog_container.post-create

			| {% with errors = errors %}
			| {% if errors %}
			| {% for field in errors %}
			.alert.alert-danger(role='alert')
				strong {{field}}
				| 						{% for message in errors[field] %}
				| 								{{message}}|
				| 						{% endfor %}
			| 				{% endfor %}
			| 		{% endif %}
			| 		{% endwith %}

			#blog_index-sidebar
				.blog_project-sidebar
					input.btn.btn-default.button-create(type='submit', value="Update {{ node_type['name'] }}")
					a.btn.btn-default.button-back(href="{{ url_for('projects.view', project_url=project.url) }}")
						| Back to Project

			#blog_post-edit-container
				#blog_post-edit-title
					| Edit {{ node_type['name'] }}

				#blog_post-edit-form
					| {% for field in form %}
					| {% if field.name == 'csrf_token' %}
					| {{ field }}
					| {% else %}
					| {% if field.type == 'HiddenField' %}
					| {{ field }}
					| {% else %}
					.form-group(class="{{field.name}}")
						| {{ field.label }}
						| {{ field(class='form-control') }}
					| {% endif %}
					| {% endif %}
					| {% endfor %}


| {% endblock %}

| {% block footer_scripts%}
script(src="https://cdn.jsdelivr.net/g/ace@1.2.3(noconflict/ace.js+noconflict/mode-json.js)")

script.
	var dynSchema = $("#dyn_schema");
	//- var dynSchema = $("#dyn_schema").hide();
	var dynSchemaEditorContainer = $("<div>", {id: "dyn_schema_editor"});
	$("#dyn_schema").after(dynSchemaEditorContainer);
	var dynSchemaEditor = ace.edit("dyn_schema_editor");
	dynSchemaEditor.getSession().setValue(dynSchema.val());
	//- $("form").submit(function(e) {
	//- 	dynSchema.val(dynSchemaEditor.getSession().getValue());
	//- });
| {% endblock %}


